import sys
import math
# input= sys.stdin.buffer.readline
for _ in range(int(input())):
    n = int(input())
    arr=[int(c) for c in input().split()]
    if n <=2:
        a = max(arr)
        b = min(arr)
        c = 0
    else:
        a,b,c = float("-inf"),float("-inf"),float("-inf")
        for i in arr:
            if i >= a:
                c = b
                b = a
                a = i
                continue
            if i >= b:
                c = b
                b = i 
                continue
            if i>= c :
                c = i
    
    a-=c
    b-=c 

    if n == 1:
        print(arr[0])
    elif a-b>b:
        print(a-b)
    else:
        print(b)
